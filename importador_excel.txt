SELECT:MAIN
       E.COD_PRODUTO         AS COD_PRODUTO,
       #NOW()                AS DATA_CADASTRO,
       #NOW()                AS DATA_ATUALIZACAO,
       E.REFERENCIA          AS REFERENCIA,
       E.DESCRICAO           AS DESCRICAO1,
       E.OBS                 AS OBS,
       E.UNIDADE_COMPRA      AS UNIDADE_COMPRA,
       E.UNIDADE_ARMAZEN     AS UNIDADE_ARMAZEN,
       E.UNIDADE_USO         AS UNIDADE_VENDA,
       E.FATOR_CA            AS FATOR_CA,
       E.FATOR_AU            AS FATOR_AV,
       E.PESO                AS PESO,
       E.LARGURA             AS LARGURA,
       E.ALTURA              AS ALTURA,
       E.PROFUNDIDADE        AS PROFUNDIDADE,
       E.COMPRIMENTO         AS COMPRIMENTO,
       E.CODIGO_YOUTUBE      AS CODIGO_YOUTUBE,
       E.COD_ISBN            AS COD_ISBN,
       E.QTDE_MAX_VENDA      AS QTDE_MAX_VENDA, 
       E.EXIGE_RECEITA       AS EXIGE_RECEITA,
       E.ORIGEM_PROD         AS ORIGEM_PROD,
       "T"                   AS CONTROLA_COR,
       "T"                   AS CONTROLA_ESTAMPA,
       "T"                   AS CONTROLA_TAMANHO,  
       "F"                   AS CONTROLA_LOTE,
       "F"                   AS IBAMADO,
       E.SIT_TRIB            AS SIT_TRIB,
	  E.UNIDADE_TRIB        AS UNIDADE_TRIB,
	  E.FATOR_TRIB          AS FATOR_TRIB,
	  E.FAIXA_VALOR         AS FAIXA_VALOR,
	  E.DATA_DISP           AS DATA_DISP,
	  E.UTILIZACOES         AS UTILIZACOES,
	  E.STATUS              AS STATUS,
	  E.PAISES              AS PAISES,
       E.COD_PRODUTO_FORNEC  AS COD_PRODUTO_FORNEC,
       E.DESCRICAO_LITERAL   AS DESCRICAO_LITERAL,
       E.DESCRICAO_ETIQ      AS DESCRICAO_ETIQ,
       E.DESCRICAO_TRADUZIDA AS DESCRICAO_TRADUZIDA,
       E.ESPECIFICACAO       AS ESPECIF,
       E.VALOR_ESPECIFICACAO AS VALOR_ESPECIFICACAO,
       E.DESCRICAO_ESPECIFICACAO AS DESCRICAO_ESPECIFICACAO,
       E.GRUPO_ESPECIFICACAO AS GRUPO_ESPECIFICACAO,
       E.COR_ESPECIFICACAO AS COR_ESPECIFICACAO,
	   E.ESPECIFICACAO2       AS ESPECIF2,
       E.VALOR_ESPECIFICACAO2 AS VALOR_ESPECIFICACAO2,
       E.DESCRICAO_ESPECIFICACAO2 AS DESCRICAO_ESPECIFICACAO2,
	   E.ESPECIFICACAO3       AS ESPECIF3,
       E.VALOR_ESPECIFICACAO3 AS VALOR_ESPECIFICACAO3,
       E.DESCRICAO_ESPECIFICACAO3 AS DESCRICAO_ESPECIFICACAO3,
	   E.ESPECIFICACAO4       AS ESPECIF4,
       E.VALOR_ESPECIFICACAO4 AS VALOR_ESPECIFICACAO4,
       E.DESCRICAO_ESPECIFICACAO4 AS DESCRICAO_ESPECIFICACAO4,
	   E.ESPECIFICACAO5       AS ESPECIF5,
       E.VALOR_ESPECIFICACAO5 AS VALOR_ESPECIFICACAO5,
       E.DESCRICAO_ESPECIFICACAO5 AS DESCRICAO_ESPECIFICACAO5,
	   E.ESPECIFICACAO6       AS ESPECIF6,
       E.VALOR_ESPECIFICACAO6 AS VALOR_ESPECIFICACAO6,
       E.DESCRICAO_ESPECIFICACAO6 AS DESCRICAO_ESPECIFICACAO6,
	   E.ESPECIFICACAO7       AS ESPECIF7,
       E.VALOR_ESPECIFICACAO7 AS VALOR_ESPECIFICACAO7,
       E.DESCRICAO_ESPECIFICACAO7 AS DESCRICAO_ESPECIFICACAO7,
	   E.ESPECIFICACAO8       AS ESPECIF8,
       E.VALOR_ESPECIFICACAO8 AS VALOR_ESPECIFICACAO8,
       E.DESCRICAO_ESPECIFICACAO8 AS DESCRICAO_ESPECIFICACAO8,
	   E.ESPECIFICACAO9       AS ESPECIF9,
       E.VALOR_ESPECIFICACAO9 AS VALOR_ESPECIFICACAO9,
       E.DESCRICAO_ESPECIFICACAO9 AS DESCRICAO_ESPECIFICACAO9,
	   E.ESPECIFICACAO10       AS ESPECIF10,
       E.VALOR_ESPECIFICACAO10 AS VALOR_ESPECIFICACAO10,
       E.DESCRICAO_ESPECIFICACAO10 AS DESCRICAO_ESPECIFICACAO10,
	   E.ESPECIFICACAO11       AS ESPECIF11,
       E.VALOR_ESPECIFICACAO11 AS VALOR_ESPECIFICACAO11,
       E.DESCRICAO_ESPECIFICACAO11 AS DESCRICAO_ESPECIFICACAO11,
	   E.ESPECIFICACAO12       AS ESPECIF12,
       E.VALOR_ESPECIFICACAO12 AS VALOR_ESPECIFICACAO12,
       E.DESCRICAO_ESPECIFICACAO12 AS DESCRICAO_ESPECIFICACAO12,
	   E.ESPECIFICACAO13       AS ESPECIF13,
       E.VALOR_ESPECIFICACAO13 AS VALOR_ESPECIFICACAO13,
       E.DESCRICAO_ESPECIFICACAO13 AS DESCRICAO_ESPECIFICACAO13,
	   E.ESPECIFICACAO14       AS ESPECIF14,
       E.VALOR_ESPECIFICACAO14 AS VALOR_ESPECIFICACAO14,
       E.DESCRICAO_ESPECIFICACAO14 AS DESCRICAO_ESPECIFICACAO14,
	   E.ESPECIFICACAO15       AS ESPECIF15,
       E.VALOR_ESPECIFICACAO15 AS VALOR_ESPECIFICACAO15,
       E.DESCRICAO_ESPECIFICACAO15 AS DESCRICAO_ESPECIFICACAO15,
	   E.ESPECIFICACAO16       AS ESPECIF16,
       E.VALOR_ESPECIFICACAO16 AS VALOR_ESPECIFICACAO16,
       E.DESCRICAO_ESPECIFICACAO16 AS DESCRICAO_ESPECIFICACAO16,
	   E.ESPECIFICACAO17       AS ESPECIF17,
       E.VALOR_ESPECIFICACAO17 AS VALOR_ESPECIFICACAO17,
       E.DESCRICAO_ESPECIFICACAO17 AS DESCRICAO_ESPECIFICACAO17,
	   E.ESPECIFICACAO18       AS ESPECIF18,
       E.VALOR_ESPECIFICACAO18 AS VALOR_ESPECIFICACAO18,
       E.DESCRICAO_ESPECIFICACAO18 AS DESCRICAO_ESPECIFICACAO18,
	   E.ESPECIFICACAO19       AS ESPECIF19,
       E.VALOR_ESPECIFICACAO19 AS VALOR_ESPECIFICACAO19,
       E.DESCRICAO_ESPECIFICACAO19 AS DESCRICAO_ESPECIFICACAO19,
	   E.ESPECIFICACAO20       AS ESPECIF20,
       E.VALOR_ESPECIFICACAO20 AS VALOR_ESPECIFICACAO20,
       E.DESCRICAO_ESPECIFICACAO20 AS DESCRICAO_ESPECIFICACAO20,
       E.PERMITE_PEDIDO_SEM_ESTOQUE AS PERMITE_PEDIDO_SEM_ESTOQUE,       
       CASE WHEN UPPER(E.CLASS_PROD) = "FABRICACAO PROPRIA" THEN "F"
            WHEN UPPER(E.CLASS_PROD) = "REVENDA" THEN "R"
            WHEN UPPER(E.CLASS_PROD) = "PRODUTO IMPORTADO" THEN "I"
            WHEN UPPER(E.CLASS_PROD) = "REPRESENTACAO" THEN "P"
            WHEN UPPER(E.CLASS_PROD) = "REVENDA POR SUBSTITUICAO" THEN "U"
            WHEN UPPER(E.CLASS_PROD) = "CONSIGNADO" THEN "C" END AS CLASS_PROD,
       (SELECT MIN(A.APELIDO_CARACTERISTICA) FROM APELIDO_CARACTERISTICA A WHERE A.APELIDO = E.APELIDO_COR) AS APELIDO_COR,
       (SELECT MIN(A.APELIDO_CARACTERISTICA) FROM APELIDO_CARACTERISTICA A WHERE A.APELIDO = E.APELIDO_ESTAMPA) AS APELIDO_ESTAMPA,
       (SELECT MIN(A.APELIDO_CARACTERISTICA) FROM APELIDO_CARACTERISTICA A WHERE A.APELIDO = E.APELIDO_TAMANHO) AS APELIDO_TAMANHO,
       (SELECT MIN(PERFIL_IMPOSTO) FROM PERFIL_IMPOSTOS PI WHERE PI.DESCRICAO = E.PERFIL_IMPOSTO)  AS PERFIL_IMPOSTO,
       (SELECT MIN(GRUPO) FROM GRUPOS G WHERE G.COD_GRUPO = E.COD_GRUPO) AS GRUPO,
       (SELECT MIN(GRADE) FROM GRADES GR WHERE GR.COD_GRADE = E.GRADE) AS GRADE,
       (SELECT MIN(COLECAO) FROM COLECOES CL WHERE CL.COD_COLECAO = E.COD_COLECAO) AS COLECAO,
       (SELECT MIN(DIVISAO) FROM DIVISOES D WHERE D.COD_DIVISAO = E.COD_DIVISAO) AS DIVISAO,
       (SELECT MIN(DEPARTAMENTO) FROM DEPARTAMENTOS DP WHERE DP.COD_DEPARTAMENTO = E.COD_DEPARTAMENTO) AS DEPARTAMENTO,
       (SELECT MIN(TIPO) FROM TIPOS T WHERE T.COD_TIPO = E.COD_TIPO) AS TIPO,
       (SELECT MIN(MARCA) FROM MARCAS M WHERE M.COD_MARCA = E.COD_MARCA) AS MARCA,
       (SELECT MIN(CATEGORIA) FROM CATEGORIASP CT WHERE CT.COD_CATEGORIA = E.COD_CATEGORIA) AS CATEGORIASP,
       (SELECT MIN(SUBCOLECAO) FROM SUBCOLECOES SC WHERE SC.COD_SUBCOLECAO = E.COD_SUBCOLECAO) AS SUBCOLECAO,
       (SELECT MIN(FORNECEDOR) FROM FORNECEDORES F WHERE F.COD_FORNECEDOR = E.COD_FORNECEDOR) AS FORNECEDOR,
       (SELECT MIN(CLASSIFICACAO_FIS) FROM CLASSIFICACAO_FIS CF WHERE CF.CODIGO = E.COD_CLASSIFICACAO_FIS) AS CLASSIFICACAO_FIS,
	  (SELECT MIN(PAIS) FROM PAISES PS WHERE PS.PAIS = E.PAISES) AS PAIS,
       (SELECT MIN(UTILIZACOES) FROM UTILIZACOES UT WHERE UT.COD_UTILIZACAO = E.UTILIZACOES) AS UTILIZACOES,
	   
	   
	   
       "T" AS IMPORTACAO_PLANILHA,
       (SELECT #NULL_TO_S(P.KIT, "F") AS KIT FROM PRODUTOS P WHERE P.TIPO_PROD = "AC" AND P.COD_PRODUTO = E.COD_PRODUTO) AS KIT
       #ROWSET({SELECT:COMPONENTES_KIT C.PRODUTO, UC.COR_PRODUTO AS COR, UC.ESTAMPA_PRODUTO AS ESTAMPA, UC.TAMANHO_PRODUTO AS TAMANHO, UC.QUANTIDADE AS QTDE
                  FROM COMPONENTES C
            INNER JOIN USO_COMPONENTES UC ON UC.COMPONENTE = C.COMPONENTE
            INNER JOIN FICHAS_TECNICAS FT ON FT.FICHA_TECNICA = C.FICHA_TECNICA
            INNER JOIN COR_PROD CP ON CP.PRODUTO=C.PRODUTO AND CP.COR=UC.COR_PRODUTO
            INNER JOIN ESTAMPA_PROD EP ON EP.PRODUTO=C.PRODUTO AND EP.ESTAMPA=UC.ESTAMPA_PRODUTO
            INNER JOIN TAM_PROD TP ON TP.PRODUTO=C.PRODUTO AND TP.TAMANHO=UC.TAMANHO_PRODUTO
                 WHERE FT.PRODUTO = (SELECT P.PRODUTO FROM PRODUTOS P WHERE P.TIPO_PROD = "AC" AND P.COD_PRODUTO = :MAIN.COD_PRODUTO) AND FT.ATUAL = TRUE })
       #ROWSET({SELECT:FILIAIS F.FILIAL AS ITEM FROM PRODUTOS_IMPORTER_EXCEL E2 INNER JOIN FILIAIS F ON F.COD_FILIAL = E2.FILIAL1 WHERE E2.COD_PRODUTO = :MAIN.COD_PRODUTO
             UNION ALL
                SELECT F.FILIAL AS ITEM FROM PRODUTOS_IMPORTER_EXCEL E2 INNER JOIN FILIAIS F ON F.COD_FILIAL = E2.FILIAL2 WHERE E2.COD_PRODUTO = :MAIN.COD_PRODUTO
             UNION ALL
                SELECT F.FILIAL AS ITEM FROM PRODUTOS_IMPORTER_EXCEL E2 INNER JOIN FILIAIS F ON F.COD_FILIAL = E2.FILIAL3 WHERE E2.COD_PRODUTO = :MAIN.COD_PRODUTO })
       #ROWSET({SELECT:CORES DISTINCT COR AS COR, "A" AS ATIVO FROM CORES C INNER JOIN PRODUTOS_IMPORTER_EXCEL E2 ON E2.COD_COR = C.COD_COR AND E2.COD_PRODUTO = :MAIN.COD_PRODUTO})
       #ROWSET({SELECT:ESTAMPAS DISTINCT ESTAMPA FROM ESTAMPAS E INNER JOIN PRODUTOS_IMPORTER_EXCEL E2 ON E2.COD_ESTAMPA = E.COD_EST AND E2.COD_PRODUTO = :MAIN.COD_PRODUTO})    
       #ROWSET({SELECT:ESPECIFICACAO MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO,
	   #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
                 
                 UNION ALL
                 
                 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO2)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO2)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO2
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO3)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO3)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO3
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO4)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO4)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO4
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO5)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO5)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO5
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO6)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO6)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO6
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				
				UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO7)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO7)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO7
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO8)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO8)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO8
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO9)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO9)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO9
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO10)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO10)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO10
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO11)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO11)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO11
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO12)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO12)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO12
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO13)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO13)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO13
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO14)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO14)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO14
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO15)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO15)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO15
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO16)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO16)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO16
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO17)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO17)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO17
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO18)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO18)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO18
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO19)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO19)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO19
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 UNION ALL
				 SELECT MIN(ES.ESPECIFICACAO) AS ESPECIFICACAO ,
#IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.VALOR_ESPECIFICACAO20)) AS VALOR,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, #REPLACET(:MAIN.DESCRICAO_ESPECIFICACAO20)) AS DESCRICAO,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(GE.GRUPO_ESPEC) FROM GRUPOS_ESPEC GE WHERE GE.GRUPO = :MAIN.GRUPO_ESPECIFICACAO)) AS GRUPO_ESPEC,
                       #IF(MIN(ES.ESPECIFICACAO) IS NULL, NULL, (SELECT MIN(C.COR) FROM CORES C WHERE C.DESCRICAO = :MAIN.COR_ESPECIFICACAO)) AS COR				 
                  FROM PRODUTOS_IMPORTER_EXCEL E2 
                  INNER JOIN  ESPECIFICACOES ES ON ES.DESCRICAO = E2.ESPECIFICACAO20
                 WHERE  E2.COD_PRODUTO = :MAIN.COD_PRODUTO
				 })
    #ROWSET({SELECT:FOTOS F.CFOTO, F.ESTAMPA, F.COR, F.DESCRICAO, F.FOTO, F.TAMANHO, F.REFERENCIA, F.ESPECIFICACAO, F.ORDEM FROM FOTOS F 
            INNER JOIN PRODUTOS P ON P.PRODUTO = F.PRODUTO WHERE P.TIPO_PROD = 'AC' AND P.COD_PRODUTO = :MAIN.COD_PRODUTO})
  FROM PRODUTOS_IMPORTER_EXCEL E
 WHERE E.COD_PRODUTO <> "";